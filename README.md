# Modig Dataset Shopware Plugin

## Purpose
This plugin allows you to import different sized catalog datasets in your shopware instance.  
See the Dataset Sizes section for more details about each set.  
The plugin is intended for developers and testers who want to see how their shopware instance behaves with different sized catalogs.  

#Credits
All data and images are generated by transforming this sample shop data source: https://www.kaggle.com/datasets/paramaggarwal/fashion-product-images-dataset/discussion/166056.

## Compatibility

Shopware versions
- 6.4.*

## Prerequisites

This module contains json files with data for categories, manufacturer, properties and products. You will need to download the images from the same source as above https://www.kaggle.com/datasets/paramaggarwal/fashion-product-images-dataset/discussion/166056.  
The archive at the URL above contains, among others, a folder called `images` with all the images you need for the import.  
Copy the images on the machine where the import runs and make sure it is readable by the `bin/console` process. (in case you are using virtualization, make sure it is available inside the virtual machine).

## Usage
After installation, this module offers an extra console command. `dataset:import`  
This command receives as argument a config file in the yml format.   
See the "Configuration file" below for more details    
The command also supports a `--run` (`-r`) option.

If running this command without the `--run` (`-r`) will just validate the config file.   
With the `--run` option the actual import will start if the config is valid. If the config is not valid, the import will be aborted and you will see error messages related to wrong configuration.  
After the import is done an indexing is required `bin/console dal:refresh:index`.

## Recommendations
- It is recommended to run the command with the `--no-debug` option because when importing media files SHopware displays some logging notification related to the messages sent to the image thumbnail processor.
- it is recommended to run increase the memory limit when running the command because image processing will take a lot of memory
   - `php -d memory_limit=16G bin/console dataset:import /path/to/config/file --no-debug -r`
- When running the indexing after the import also requires a lot of memory
   - `php -d memory_limit=16G bin/console dal:refresh:index`


## Configuration File.
In order for the import to run, some configurations are needed to tell the import where the data sources are located, where the images are and provide some default values for the script  
There are sample config files inside the module in `src/Resources/config/import/*.yml`. One for each supported sample size. The files do not contain the path to the actual images.   
You can copy one of the file in a different location and fill in the path to images.   
You can also edit one of the files directly if you're in developer mode.

You can run the imports incrementally by setting the `skip` flag for each entity to import, but make sure you run them in order.   
You cannot import products without first importing categories, properties, manufacturers and media

## Config File Structure.
In an ideal scenario you leave everything as it is and just fill in the media->images value. 
Here is a detailed description of the 10k sample size.  
```yaml   
category: #category import configuration    
  skip: false #set to true to skip category import    
  root: #root category configuration    
    auto: true #auto = true means the system will look for a root category. If this is set to false and no id is provided, a new category called Root will be created    
    #id: 1234 - you can remove the auto part and fill in a valid category UUID here    
  layout:    
    name: "Default listing layout" # name of the layout instance to be used as default    
    #id: 1234 - you can remove the name part and fill in a valid Layout UUID here  
  source: "@ModigDataset/Resources/source/10k/categories.json" #source file(s) of the categories. You can use the @ prefix to read it from a specific bundle 
  
manufacturer: #manufacturer import configuration    
  skip: false #set to true to skip importing manufacturers    
  source: "@ModigDataset/Resources/source/10k/manufacturers.json" #source file(s) of the manufacturers. You can use the @ prefix to read it from a specific bundle
     
property: #properties import configuration  
  skip: false #set to true to skip importing properties    
  source: "@ModigDataset/Resources/source/10k/properties.json" #source file(s) of the properties. You can use the @ prefix to read it from a specific bundle
     
media: #properties import configuration    
  skip: false #set to true to skip importing media  
  folder: #product folder where images are going to be stored    
    entity: product #by default it will look for the product media folder    
    #id: 1234 #you can uncomment this and provide a valid media_default_folder id    
  source: "@ModigDataset/Resources/source/10k/media/*.json" #source file(s) of the media config. You can use the @ prefix to read it from a specific bundle    
  images: "" #fill in here the location if the images to import
     
product: #product configuration settings  
  skip: false #set to true to skip product import  
  stock: 1000 #default value for stock qty for products    
  source: "@ModigDataset/Resources/source/10k/product/product_*.json" #source file(s) of the products. You can use the @ prefix to read it from a specific bundle    
  tax: #default tax configuration    
    name: "Standard rate" #name of the tax to be used as default    
    #id: 1234 #you can specify a valid tax UUID instead of name    
  sales_channel: #default saleschannel configuration    
    name: "Storefront" # default saleschannel name    
    #id: 1234 #you can also provide a valid sales channel UUID
     
global: #global configuration settings used by all entities import    
  language: #default language setting    
    name: English #default language name    
    #id: 1234 you can add here a valid language id instead of name   
```


## Sample Sizes

Sample sizes can be installed incrementally, but importing a bigger sample size over a smaller one.  
Example, you can import the 10k package over the 1k package.  
It does not work the other way around.  

 - 500: corresponding config file is src/Resources/config/import/500.yml  
   - Properties  
     - 79 property group records  
     - 299 property records  
   - Manufacturers  
     - 19 records  
   - Categories  
     - 192 records  
   - Media  
     - 591 records  
   - Products
     - Simple (no variants) 73 records  
     - Configurable  
       - By Size only  
         - 233 main products  
         - 1242 variants    
       - By Size and color  
         - 194 main products  
         - 1988 variants  
 - 1k: corresponding config file is src/Resources/config/import/1k.yml  
    - Properties
        - 94 property group records
        - 403 property records
    - Manufacturers
        - 28 records
    - Categories
        - 202 records
    - Media
        - 1110 records
    - Products
        - Simple (no variants) 191 records
        - Configurable
            - By Size only
                - 438 main products
                - 2285 variants
            - By Size and color
                - 371 main products
                - 3660 variants  
 - 5k: corresponding config file is src/Resources/config/import/5k.yml  
    - Properties
        - 130 property group records
        - 711 property records
    - Manufacturers
        - 92 records
    - Categories
        - 240 records
    - Media
        - 5346 records
    - Products
        - Simple (no variants) 545 records
        - Configurable
            - By Size only
                - 2765 main products
                - 1690 variants
            - By Size and color
                - 14464 main products
                - 20229 variants  
 - 10k: corresponding config file is src/Resources/config/import/10k.yml  
    - Properties
        - 170 property group records
        - 963 property records
    - Manufacturers
        - 156 records
    - Categories
        - 242 records
    - Media
        - 10424 records
    - Products
        - Simple (no variants) 1514 records
        - Configurable
            - By Size only
                - 4814 main products
                - 23734 variants
            - By Size and color
                - 3672 main products
                - 38024 variants  
 - 15k: corresponding config file is src/Resources/config/import/15k.yml
    - Properties
        - 187 property group records
        - 1165 property records
    - Manufacturers
        - 207 records
    - Categories
        - 254 records
    - Media
        - 15455 records
    - Products
        - Simple (no variants) 2689 records
        - Configurable
            - By Size only
                - 6757 main products
                - 32513 variants
            - By Size and color
                - 5554 main products
                - 60821 variants  
 - 20k: corresponding config file is src/Resources/config/import/20k.yml
    - Properties
        - 193 property group records
        - 1649 property records
    - Manufacturers
        - 309 records
    - Categories
        - 254 records
    - Media
        - 25395 records
    - Products
        - Simple (no variants) 4987 records
        - Configurable
            - By Size only
                - 11400 main products
                - 54549 variants
            - By Size and color
                - 8613 main products
                - 92926 variants  
- full: corresponding config file is src/Resources/config/import/full.yml
    - Properties
        - 203 property group records
        - 2676 property records
    - Manufacturers
        - 403 records
    - Categories
        - 256 records
    - Media
        - 37603 records
    - Products
        - Simple (no variants) 10284 records
        - Configurable
            - By Size only
                - 15177 main products
                - 72126 variants
            - By Size and color
                - 11860 main products
                - 126218 variants  
