# Modig Dataset Shopware Plugin

## Purpose
This module is allows you to import a large dataset into your shopware instance.  
This module will install
- ~220 categories
- ~500 manufacturers
- ~200 properties with options
- ~37.5k images
- ~235k products
   - ~37k simple and main products with variations
   - ~198k product variations
     - variations can be by size, color or size and color

#Credits
All data and images are generated by transforming this sample shop data source: https://www.kaggle.com/datasets/paramaggarwal/fashion-product-images-dataset/discussion/166056.

## Compatibility

Shopware versions
- 6.4.*

## Prerequisites

This module contains json files with data for categories, manufacturer, properties and products. You will need to download the images from the same source as above https://www.kaggle.com/datasets/paramaggarwal/fashion-product-images-dataset/discussion/166056.  
The archive at the URL above contains, among others, a folder called `images` with all the images you need for the import.  
Copy the images on the machine where the import runs and make sure it is readeble by the `bin/console` process. (in case you are using virtualization, make sure it is available inside the virtual machine).

## Usage
After installation, this module offers an extra console command. `dataset:import`  
This command receives as argument a config file in the yml format.   
See the "Configuration file" below for more details    
The command also supports a `--run` (`-r) option.

If running this command without the `--run` (`-r`) will just validate the config file.   
With the `--run` option the actual import will start if the config is valid. If the config is not valid, the import will be aborted and you will see error messages related to wrong configuration.  
After the import is done an indexing is required `bin/console dal:refresh:index`.

## Recommendations
- It is recommended to run the command with the `--no-debug` option because when importing media files SHopware displays some logging notification related to the messages sent to the image thumbnail processor.
- it is recommended to run increase the memory limit when running the command because image processing will take a lot of memory
   - `php -d memory_limit=16G bin/console dataset:import /path/to/config/file --no-debug -r`
- When running the indexing after the import also requires a lot of memory
   - `php -d memory_limit=16G bin/console dal:refresh:index`


## Configuration File.
In order for the import to run, some configurations are needed to tell the import where the data sources are located, where the images are and provide some default values for the script  
There is a sample config file inside the module in `src/Resources/config/import.yml`. This file does not contain the path to the actual images.   
You can copy the file in a different location and fill in the path to images.   
You can also edit the file directly if you're in developer mode.

You can run the imports incrementally by setting the `skip` flag for each entity to import, but make sure you run them in order.   
You cannot import products without first importing categories, properties, manufacturers and media

## Config File Structure.
In an ideal scenario you leave everything as it is and just fill in the media->images value.
```yaml   
category: #category import configuration    
  skip: false #set to true to skip category import    
  root: #root category configuration    
    auto: true #auto = true means the system will look for a root category. If this is set to false and no id is provided, a new category called Root will be created    
    #id: 1234 - you can remove the auto part and fill in a valid category UUID here    
  layout:    
    name: "Default listing layout" # name of the layout instance to be used as default    
    #id: 1234 - you can remove the name part and fill in a valid Layout UUID here  
  source: "@ModigDataset/Resources/source/categories.json" #source file(s) of the categories. You can use the @ prefix to read it from a specific bundle 
  
manufacturer: #manufacturer import configuration    
  skip: false #set to true to skip importing manufacturers    
  source: "@ModigDataset/Resources/source/manufacturers.json" #source file(s) of the manufacturers. You can use the @ prefix to read it from a specific bundle
     
property: #properties import configuration  
  skip: false #set to true to skip importing properties    
  source: "@ModigDataset/Resources/source/properties.json" #source file(s) of the properties. You can use the @ prefix to read it from a specific bundle
     
media: #properties import configuration    
  skip: false #set to true to skip importing media  
  folder: #product folder where images are going to be stored    
    entity: product #by default it will look for the product media folder    
    #id: 1234 #you can uncomment this and provide a valid media_default_folder id    
  source: "@ModigDataset/Resources/source/media/*.json" #source file(s) of the media config. You can use the @ prefix to read it from a specific bundle    
  images: "" #fill in here the location if the images to import
     
product: #product configuration settings  
  skip: false #set to true to skip product import  
  stock: 1000 #default value for stock qty for products    
  source: "@ModigDataset/Resources/source/product/product_*.json" #source file(s) of the products. You can use the @ prefix to read it from a specific bundle    
  tax: #default tax configuration    
    name: "Standard rate" #name of the tax to be used as default    
    #id: 1234 #you can specify a valid tax UUID instead of name    
  sales_channel: #default saleschannel configuration    
    name: "Storefront" # default saleschannel name    
    #id: 1234 #you can also provide a valid sales channel UUID
     
global: #global configuration settings used by all entities import    
  language: #default language setting    
    name: English #default language name    
    #id: 1234 you can add here a valid language id instead of name   
```
